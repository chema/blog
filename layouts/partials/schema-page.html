{{/* 
  schema-page.html

  Outputs JSON-LD structured data for posts in mainSections (e.g. "post").
  Accepts front matter 'schemaType' such as OpinionNewsArticle, Report, CreativeWork.
  Defaults to BlogPosting if not specified.

  schemaType front matter is mapped as follows:
  - OpinionNewsArticle, AnalysisNewsArticle → NewsArticle
  - BlogPosting, CreativeWork → BlogPosting
  - All others → Article (default)

  Other types (e.g. Report, OpinionNewsArticle) are valid Schema.org types but are not
  currently eligible for Google rich results. They still improve semantic indexing.
*/}}

{{ if and .IsPage (eq .Type "post") }}

{{ $rawType := .Params.schemaType | default "" }}
{{ $type := "Article" }}
{{ if in (slice "OpinionNewsArticle" "AnalysisNewsArticle") $rawType }}
  {{ $type = "NewsArticle" }}
{{ else if in (slice "BlogPosting" "CreativeWork") $rawType }}
  {{ $type = "BlogPosting" }}
{{ end }}

{{ $author := .Site.Params.Author }}
{{ $url := .Permalink }}
{{ $headline := .Title }}
{{ $description := .Params.description | default .Summary }}
{{ $datePublished := .Date.Format "2006-01-02T15:04:05Z07:00" }}
{{ $dateModified := .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}
{{ $base := .Site.Params.url | default .Site.BaseURL }}
{{ $publisher := .Site.Params.title }}
{{ $image := "" }}
{{ with .Params.image }}
  {{ $image = path.Join $base . }}
{{ end }}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{{ $type }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ $url }}"
  },
  "headline": "{{ $headline }}",
  "description": "{{ $description }}",
  {{ if $image }}
  "image": "{{ $image }}",
  {{ end }}
  "datePublished": "{{ $datePublished }}",
  "dateModified": "{{ $dateModified }}",
  "author": {
    "@type": "Person",
    "name": "{{ $author }}",
	"url": "{{ $base }}/about/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ $publisher }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ $base }}/img/a-san-franciscan-sea-lion-logo-2025-192x192.png"
    }
  }
}
</script>

{{ end }}